# -*- coding: utf-8 -*-
"""
Full Menu Commands - Menu ƒë·∫ßy ƒë·ªß v·ªõi t·∫•t c·∫£ l·ªánh c·ªßa bot
"""
import discord
from discord.ext import commands
import logging
from datetime import datetime

logger = logging.getLogger(__name__)

class FullMenuView(discord.ui.View):
    def __init__(self, bot_instance):
        super().__init__(timeout=300)
        self.bot_instance = bot_instance
    
    @discord.ui.button(label="üéÆ Games", style=discord.ButtonStyle.primary, emoji="üéÆ")
    async def games_button(self, interaction: discord.Interaction, button: discord.ui.Button):
        embed = discord.Embed(
            title="üéÆ Games & Gi·∫£i Tr√≠",
            description="T·∫•t c·∫£ games c√≥ s·∫µn trong bot",
            color=discord.Color.blue(),
            timestamp=datetime.now()
        )
        
        embed.add_field(
            name="üé≤ T√†i X·ªâu",
            value=(
                "`;taixiu tai <ti·ªÅn>` - C∆∞·ª£c t√†i\n"
                "`;taixiu xiu <ti·ªÅn>` - C∆∞·ª£c x·ªâu\n"
                "`;taixiustats [@user]` - Th·ªëng k√™\n"
                "`;give @user <ti·ªÅn>` - T·∫∑ng ti·ªÅn\n"
                "`;balance [@user]` - Xem s·ªë d∆∞"
            ),
            inline=True
        )
        
        embed.add_field(
            name="‚úÇÔ∏è Rock Paper Scissors",
            value=(
                "`;rps <ti·ªÅn>` - Ch∆°i RPS\n"
                "`;rpsstats [@user]` - Th·ªëng k√™ RPS\n"
                "**D√πng buttons ƒë·ªÉ ch·ªçn**"
            ),
            inline=True
        )
        
        embed.add_field(
            name="üé∞ Slot Machine",
            value=(
                "`;slot <ti·ªÅn>` - Quay slot\n"
                "`;slotstats [@user]` - Th·ªëng k√™ slot\n"
                "**L∆∞u √Ω:** Game thu·∫ßn may r·ªßi"
            ),
            inline=True
        )
        
        embed.add_field(
            name="üÉè Blackjack",
            value=(
                "`;blackjack <ti·ªÅn>` - Ch∆°i blackjack\n"
                "`;bjstats [@user]` - Th·ªëng k√™ BJ\n"
                "**D√πng buttons:** Hit/Stand/Double"
            ),
            inline=True
        )
        
        embed.add_field(
            name="ü™ô Flip Coin",
            value=(
                "`;flip heads <ti·ªÅn>` - C∆∞·ª£c ng·ª≠a\n"
                "`;flip tails <ti·ªÅn>` - C∆∞·ª£c s·∫•p\n"
                "`;flipstats [@user]` - Th·ªëng k√™ flip"
            ),
            inline=True
        )
        
        embed.add_field(
            name="üèÜ Weekly Leaderboard",
            value=(
                "`;weeklytop` / `;bangdua` - B·∫£ng ƒëua\n"
                "`;myleaderboard` / `;hangtoi` - Rank c√° nh√¢n\n"
                "`;weeklyhistory` - L·ªãch s·ª≠ tu·∫ßn\n"
                "`;resetweekly` - Reset tu·∫ßn (Admin)"
            ),
            inline=False
        )
        
        embed.add_field(
            name="üé£ Fishing System",
            value=(
                "`;cauca` / `;fishing` - C√¢u c√°\n"
                "`;sell [c√°] [s·ªë]` - B√°n c√°\n"
                "`;kho` / `;inventory` - Xem kho c√°\n"
                "`;topfish` - BXH c√¢u c√°"
            ),
            inline=True
        )
        
        embed.add_field(
            name="üí∞ Wallet System",
            value=(
                "`;wallet` - Menu v√≠ ti·ªÅn\n"
                "`;daily` - Nh·∫≠n th∆∞·ªüng h√†ng ng√†y\n"
                "`;walletreload` - Reload v√≠ (Admin)\n"
                "`;wallettop` - Top gi√†u nh·∫•t"
            ),
            inline=True
        )
        
        embed.set_footer(text="Game Balance: ‚â•100M xu = 30% th·∫Øng ‚Ä¢ Unluck system: 0% th·∫Øng vƒ©nh vi·ªÖn ‚Ä¢ Fishing: 5min cooldown")
        await interaction.response.edit_message(embed=embed, view=self)
    
    @discord.ui.button(label="üëë Admin Panel", style=discord.ButtonStyle.danger, emoji="üëë")
    async def admin_button(self, interaction: discord.Interaction, button: discord.ui.Button):
        """Hi·ªÉn th·ªã l·ªánh Admin v√† Supreme Admin"""
        # Ki·ªÉm tra quy·ªÅn h·∫°n
        user_id = interaction.user.id
        is_supreme_admin = self.bot_instance.is_supreme_admin(user_id)
        is_admin = self.bot_instance.is_admin(user_id)
        
        if not is_admin and not is_supreme_admin:
            # User th∆∞·ªùng kh√¥ng c√≥ quy·ªÅn xem
            embed = discord.Embed(
                title="‚ùå Kh√¥ng c√≥ quy·ªÅn truy c·∫≠p",
                description="Ch·ªâ Admin v√† Supreme Admin m·ªõi c√≥ th·ªÉ xem menu n√†y!",
                color=discord.Color.red(),
                timestamp=datetime.now()
            )
            
            embed.add_field(
                name="üîí Quy·ªÅn h·∫°n c·ªßa b·∫°n:",
                value="üë§ **User th∆∞·ªùng**",
                inline=True
            )
            
            embed.add_field(
                name="üìã ƒê·ªÉ xem l·ªánh c·ªßa b·∫°n:",
                value="S·ª≠ d·ª•ng c√°c n√∫t kh√°c trong menu",
                inline=True
            )
            
            embed.set_footer(text="Access Denied ‚Ä¢ Admin Only")
            await interaction.response.edit_message(embed=embed, view=self)
            return
        
        # X√°c ƒë·ªãnh role hi·ªÉn th·ªã
        if is_supreme_admin:
            role_name = "Supreme Admin"
            role_color = discord.Color.gold()
            role_emoji = "üëë"
        else:
            role_name = "Admin"
            role_color = discord.Color.blue()
            role_emoji = "üõ°Ô∏è"
        
        embed = discord.Embed(
            title=f"üëë ADMIN PANEL - {role_emoji} {role_name.upper()}",
            description=f"**T·∫•t c·∫£ l·ªánh qu·∫£n tr·ªã v√† moderation d√†nh cho {role_name}**\n"
                       f"üí¨ **Admin c√≥ th·ªÉ s·ª≠ d·ª•ng t·∫•t c·∫£ l·ªánh qua DM**",
            color=role_color,
            timestamp=datetime.now()
        )
        
        # 1. ADMIN COMMANDS
        embed.add_field(
            name="üõ°Ô∏è ADMIN COMMANDS",
            value=(
                "**`;adminmenu`** - Menu admin chi ti·∫øt\n"
                "**`;give @user <xu>`** - T·∫∑ng xu cho user\n"
                "**`;unluck add/remove @user`** - Qu·∫£n l√Ω xui x·∫ªo\n"
                "**`;shop hanghoa`** - Qu·∫£n l√Ω kho h√†ng\n"
                "**`;pendingorders`** - Xem ƒë∆°n h√†ng ch·ªù\n"
                "**`;bye <n·ªôi dung>`** - Tin nh·∫Øn t·∫°m bi·ªát\n"
                "**`;reply <user_id> <n·ªôi dung>`** - Auto-reply"
            ),
            inline=True
        )
        
        # 2. MODERATION COMMANDS
        embed.add_field(
            name="üî® MODERATION",
            value=(
                "**`;purge <s·ªë>`** - X√≥a tin nh·∫Øn h√†ng lo·∫°t\n"
                "**`;purgeuser @user <s·ªë>`** - X√≥a tin nh·∫Øn c·ªßa user\n"
                "**`;xoa on/off @user`** - Auto delete tin nh·∫Øn\n"
                "**`;channelrestrict add @user #channel`** - H·∫°n ch·∫ø k√™nh\n"
                "**`;antiabuse on/off`** - H·ªá th·ªëng ch·ªëng x√∫c ph·∫°m\n"
                "**`;antiabuse stats`** - Th·ªëng k√™ vi ph·∫°m"
            ),
            inline=True
        )
        
        # 3. BAN SYSTEM (cho t·∫•t c·∫£ admin)
        embed.add_field(
            name="üö´ BAN SYSTEM",
            value=(
                "**`;banlist`** - Danh s√°ch user b·ªã ban\n"
                "**`;checkban <user_id>`** - Ki·ªÉm tra tr·∫°ng th√°i ban\n" +
                ("**`;ban <user_id> [l√Ω do]`** - Ban user\n"
                "**`;unban <user_id> [l√Ω do]`** - Unban user\n"
                "**`;banhistory [s·ªë]`** - L·ªãch s·ª≠ ban" if is_supreme_admin else 
                "**Ch·ªâ Supreme Admin:** Ban/Unban users")
            ),
            inline=True
        )
        
        # 4. SUPREME ADMIN COMMANDS (ch·ªâ hi·ªÉn th·ªã cho supreme admin)
        if is_supreme_admin:
            embed.add_field(
                name="üëë SUPREME ADMIN ONLY",
                value=(
                    "**`;resetuserdata`** - Reset d·ªØ li·ªáu user\n"
                    "**`;resetexp`** - Reset t·∫•t c·∫£ EXP Rare\n"
                    "**`;reload [module]`** - Reload bot modules\n"
                    "**`;backup sync/migrate/restore`** - Qu·∫£n l√Ω backup\n"
                    "**`;shutdown`** - T·∫Øt bot ho√†n to√†n (Nguy hi·ªÉm!)"
                ),
                inline=False
            )
        
        # 5. SYSTEM MANAGEMENT
        embed.add_field(
            name="‚öôÔ∏è SYSTEM INFO",
            value=(
                "**`;status`** - Tr·∫°ng th√°i bot\n"
                "**`;checkpermissions`** - Ki·ªÉm tra quy·ªÅn h·∫°n\n"
                "**`;nhom`** - Xem nh√≥m quy·ªÅn\n"
                f"**Your Role:** {role_emoji} {role_name}\n"
                f"**DM Support:** Full Access"
            ),
            inline=True
        )
        
        embed.set_footer(
            text=f"üëë Admin Panel ‚Ä¢ {role_name} ‚Ä¢ All Commands Available ‚Ä¢ DM Supported",
            icon_url=interaction.user.display_avatar.url
        )
        
        await interaction.response.edit_message(embed=embed, view=self)
    
    @discord.ui.button(label="üõí Shop", style=discord.ButtonStyle.success, emoji="üõí")
    async def shop_button(self, interaction: discord.Interaction, button: discord.ui.Button):
        embed = discord.Embed(
            title="üõí Shop System",
            description="H·ªá th·ªëng mua b√°n EXP Rare",
            color=discord.Color.green(),
            timestamp=datetime.now()
        )
        
        embed.add_field(
            name="üë§ User Commands",
            value=(
                "`;shop` - Xem shop EXP Rare\n"
                "`;buy exp <s·ªë>` - Mua g√≥i EXP (1-10)\n"
                "`;exprare [@user]` - Xem EXP Rare\n"
                "**Ch·ªâ d√πng trong k√™nh shop**"
            ),
            inline=True
        )
        
        embed.add_field(
            name="üëë Admin Commands",
            value=(
                "`;setshop [#k√™nh]` - C·∫•u h√¨nh k√™nh shop\n"
                "`;shopconfig` - Xem c·∫•u h√¨nh shop\n"
                "`;stop` - Ho√†n th√†nh ƒë∆°n h√†ng (trong order)\n"
                "`;refund [l√Ω do]` - Ho√†n ti·ªÅn (trong order)\n"
                "`;giveexp @user <s·ªë>` - Trao EXP th·ªß c√¥ng"
            ),
            inline=True
        )
        
        embed.add_field(
            name="üé≠ Role Management",
            value=(
                "`;role add @Role` - Th√™m role truy c·∫≠p order\n"
                "`;role remove @Role` - X√≥a role\n"
                "`;role list` - Xem danh s√°ch role\n"
                "**Quy·ªÅn:** Admin+"
            ),
            inline=True
        )
        
        embed.add_field(
            name="üì¶ G√≥i EXP Rare",
            value=(
                "**G√≥i 1:** 100M xu ‚Üí 1,000 EXP\n"
                "**G√≥i 5:** 500M xu ‚Üí 5,000 EXP\n"
                "**G√≥i 10:** 1B xu ‚Üí 10,000 EXP\n"
                "**ƒêi·ªÅu ki·ªán:** Ch∆°i ‚â•10 v√°n, c∆∞·ª£c ‚â•10M"
            ),
            inline=True
        )
        
        embed.add_field(
            name="üîß System Commands",
            value=(
                "`;checkshoppermissions` - Ki·ªÉm tra quy·ªÅn bot\n"
                "`;resetexp` - Reset t·∫•t c·∫£ EXP (Supreme Admin)\n"
                "**Bot c·∫ßn quy·ªÅn:** Manage Channels"
            ),
            inline=True
        )
        
        embed.set_footer(text="Shop System ‚Ä¢ K√™nh ri√™ng cho mua b√°n ‚Ä¢ Order channels private")
        await interaction.response.edit_message(embed=embed, view=self)
    
    @discord.ui.button(label="ü§ñ AI & Utils", style=discord.ButtonStyle.secondary, emoji="ü§ñ")
    async def ai_utils_button(self, interaction: discord.Interaction, button: discord.ui.Button):
        embed = discord.Embed(
            title="ü§ñ AI & Utilities",
            description="AI commands v√† ti·ªán √≠ch kh√°c",
            color=discord.Color.purple(),
            timestamp=datetime.now()
        )
        
        embed.add_field(
            name="üß† AI Commands",
            value=(
                "`;ask <c√¢u h·ªèi>` - Chat v·ªõi AI\n"
                "Mention bot + c√¢u h·ªèi\n"
                "Reply tin nh·∫Øn bot\n"
                "**Model:** Gemini Pro"
            ),
            inline=True
        )
        
        embed.add_field(
            name="üò¥ AFK System",
            value=(
                "`;afk [l√Ω do]` - ƒê·∫∑t tr·∫°ng th√°i AFK\n"
                "`;unafk` - B·ªè AFK th·ªß c√¥ng\n"
                "`;afklist` - Danh s√°ch AFK\n"
                "**Auto unAFK** khi chat"
            ),
            inline=True
        )
        
        embed.add_field(
            name="üëã Bye System",
            value=(
                "`;bye <n·ªôi dung>` - ƒê·∫∑t tin nh·∫Øn bye (Admin)\n"
                "`;bye off` - T·∫Øt bye system (Admin)\n"
                "`;byelist` - Xem danh s√°ch bye (Admin)\n"
                "**Auto bye** khi user leave"
            ),
            inline=True
        )
        
        embed.add_field(
            name="üé≠ Nickname System",
            value=(
                "`;nickcontrol` - Menu ki·ªÉm so√°t nickname (Admin)\n"
                "`;setnick @user <t√™n>` - ƒê·ªïi nickname (Admin)\n"
                "**Bot c·∫ßn quy·ªÅn:** Manage Nicknames"
            ),
            inline=True
        )
        
        embed.add_field(
            name="üìä Info Commands",
            value=(
                "`;info` - Th√¥ng tin bot\n"
                "`;ping` - Ki·ªÉm tra ping\n"
                "`;status` - Tr·∫°ng th√°i h·ªá th·ªëng\n"
                "`;uptime` - Th·ªùi gian ho·∫°t ƒë·ªông"
            ),
            inline=True
        )
        
        embed.add_field(
            name="üîß System Commands",
            value=(
                "`;reload [module]` - Reload module (Supreme Admin)\n"
                "`;backup sync/migrate/status` - Backup system\n"
                "`;checkpermissions` - Ki·ªÉm tra quy·ªÅn bot\n"
                "`;purge <s·ªë>` - X√≥a tin nh·∫Øn h√†ng lo·∫°t\n"
                "`;purgeuser @user <s·ªë>` - X√≥a tin nh·∫Øn user"
            ),
            inline=True
        )
        
        embed.set_footer(text="AI System ‚Ä¢ Utilities ‚Ä¢ System Management")
        await interaction.response.edit_message(embed=embed, view=self)
    
    @discord.ui.button(label="üõ°Ô∏è Anti-Abuse", style=discord.ButtonStyle.secondary, emoji="üõ°Ô∏è")
    async def anti_abuse_button(self, interaction: discord.Interaction, button: discord.ui.Button):
        embed = discord.Embed(
            title="üõ°Ô∏è Anti-Abuse System",
            description="H·ªá th·ªëng ch·ªëng x√∫c ph·∫°m t·ª± ƒë·ªông",
            color=discord.Color.orange(),
            timestamp=datetime.now()
        )
        
        embed.add_field(
            name="‚ö° C√°ch ho·∫°t ƒë·ªông",
            value=(
                "‚Ä¢ Ph√°t hi·ªán khi user tag bot + ch·ª≠i b·ªõi\n"
                "‚Ä¢ Ph√°t hi·ªán khi d√πng l·ªánh `;ask` + ch·ª≠i b·ªõi\n"
                "‚Ä¢ T·ª± ƒë·ªông x√≥a tin nh·∫Øn x√∫c ph·∫°m\n"
                "‚Ä¢ T·ª± ƒë·ªông reply: \"ƒê·ª° ngu h∆°n m l√† ƒë∆∞·ª£c\"\n"
                "‚Ä¢ Ph·∫£n h·ªìi ngay l·∫≠p t·ª©c m·ªói l·∫ßn vi ph·∫°m\n"
                "‚Ä¢ Th·ªëng k√™ vi ph·∫°m chi ti·∫øt"
            ),
            inline=False
        )
        
        embed.add_field(
            name="üëë Admin Commands",
            value=(
                "`;antiabuse` - Menu h∆∞·ªõng d·∫´n\n"
                "`;antiabuse status` - Xem tr·∫°ng th√°i h·ªá th·ªëng\n"
                "`;antiabuse on/off` - B·∫≠t/t·∫Øt h·ªá th·ªëng\n"
                "`;antiabuse stats` - Th·ªëng k√™ vi ph·∫°m\n"
                "`;antiabuse test <text>` - Test ph√°t hi·ªán"
            ),
            inline=True
        )
        
        embed.add_field(
            name="üîç Database t·ª´ x√∫c ph·∫°m",
            value=(
                "**Ti·∫øng Vi·ªát:** ngu, ng·ªëc, kh√πng, ƒëi√™n, ƒë·∫ßn...\n"
                "**Ti·∫øng Anh:** stupid, idiot, dumb, shit...\n"
                "**Vi·∫øt t·∫Øt:** wtf, stfu, dmm, vcl...\n"
                "**T·ªïng c·ªông:** 60+ t·ª´ x√∫c ph·∫°m"
            ),
            inline=True
        )
        
        embed.add_field(
            name="üìä Th·ªëng k√™",
            value=(
                "‚Ä¢ T·ªïng s·ªë l·∫ßn ph√°t hi·ªán\n"
                "‚Ä¢ Top violators (user vi ph·∫°m nhi·ªÅu)\n"
                "‚Ä¢ Vi ph·∫°m g·∫ßn ƒë√¢y v·ªõi timestamp\n"
                "‚Ä¢ T·ª´ x√∫c ph·∫°m ƒë∆∞·ª£c ph√°t hi·ªán\n"
                "‚Ä¢ L∆∞u tr·ªØ trong data/anti_abuse_data.json"
            ),
            inline=False
        )
        
        embed.set_footer(text="üõ°Ô∏è Anti-Abuse System ‚Ä¢ B·∫£o v·ªá bot kh·ªèi x√∫c ph·∫°m ‚Ä¢ Admin only")
        await interaction.response.edit_message(embed=embed, view=self)
    
    @discord.ui.button(label="üîÑ Reset", style=discord.ButtonStyle.danger, emoji="üîÑ")
    async def reset_button(self, interaction: discord.Interaction, button: discord.ui.Button):
        embed = discord.Embed(
            title="üîÑ Reset System",
            description="H·ªá th·ªëng reset l·ªãch s·ª≠ ch∆°i v√† t√†i s·∫£n",
            color=discord.Color.dark_red(),
            timestamp=datetime.now()
        )
        
        embed.add_field(
            name="üëë Supreme Admin Only",
            value=(
                "`;resetuser [@user]` - Reset to√†n b·ªô d·ªØ li·ªáu 1 user\n"
                "`;resetall` - Reset to√†n b·ªô h·ªá th·ªëng\n"
                "**‚ö†Ô∏è C·ª∞C K·ª≤ NGUY HI·ªÇM - KH√îNG TH·ªÇ HO√ÄN T√ÅC**"
            ),
            inline=False
        )
        
        embed.add_field(
            name="üõ°Ô∏è Admin Commands",
            value=(
                "`;resetgames [@user]` - Reset ch·ªâ l·ªãch s·ª≠ games\n"
                "`;resetmoney [@user]` - Reset ch·ªâ ti·ªÅn\n"
                "`;resetstats` - Xem th·ªëng k√™ tr∆∞·ªõc khi reset"
            ),
            inline=True
        )
        
        embed.add_field(
            name="üìä Files ƒê∆∞·ª£c Reset",
            value=(
                "‚Ä¢ **Shared Wallet** - S·ªë d∆∞ ti·ªÅn\n"
                "‚Ä¢ **Game Data** - T√†i x·ªâu, RPS, Slot, BJ, Flip\n"
                "‚Ä¢ **System Data** - Daily, Shop, Leaderboard\n"
                "‚Ä¢ **Backup** - T·ª± ƒë·ªông backup khi reset all"
            ),
            inline=True
        )
        
        embed.add_field(
            name="‚ö†Ô∏è X√°c Nh·∫≠n B·∫Øt Bu·ªôc",
            value=(
                "**Reset User:** Reply `CONFIRM` trong 30s\n"
                "**Reset All:** Reply `RESET ALL CONFIRM` trong 60s\n"
                "**Timeout:** T·ª± ƒë·ªông h·ªßy n·∫øu kh√¥ng x√°c nh·∫≠n"
            ),
            inline=False
        )
        
        embed.add_field(
            name="üîí B·∫£o M·∫≠t",
            value=(
                "‚Ä¢ **Kh√¥ng th·ªÉ ho√†n t√°c** - D·ªØ li·ªáu x√≥a vƒ©nh vi·ªÖn\n"
                "‚Ä¢ **Backup t·ª± ƒë·ªông** - Ch·ªâ cho reset all\n"
                "‚Ä¢ **Logging ƒë·∫ßy ƒë·ªß** - Theo d√µi m·ªçi ho·∫°t ƒë·ªông"
            ),
            inline=True
        )
        
        embed.set_footer(text="‚ö†Ô∏è S·ª¨ D·ª§NG C·∫®N TH·∫¨N - H√ÄNH ƒê·ªòNG KH√îNG TH·ªÇ HO√ÄN T√ÅC")
        await interaction.response.edit_message(embed=embed, view=self)
    
    @discord.ui.button(label="üìã All Commands", style=discord.ButtonStyle.secondary, emoji="üìã")
    async def all_commands_button(self, interaction: discord.Interaction, button: discord.ui.Button):
        embed = discord.Embed(
            title="üìã T·∫•t C·∫£ L·ªánh Bot",
            description="Danh s√°ch ƒë·∫ßy ƒë·ªß m·ªçi l·ªánh c√≥ trong bot",
            color=discord.Color.gold(),
            timestamp=datetime.now()
        )
        
        embed.add_field(
            name="üéÆ Games (15+ l·ªánh)",
            value=(
                "`;taixiu`, `;rps`, `;slot`, `;blackjack`, `;flip`\n"
                "`;weeklytop`, `;daily`, `;wallet`, `;balance`\n"
                "**+ Stats commands cho t·ª´ng game**"
            ),
            inline=True
        )
        
        embed.add_field(
            name="üõ°Ô∏è Moderation (25+ l·ªánh)",
            value=(
                "`;ban`, `;unban`, `;unluck`, `;purge`\n"
                "`;xoa`, `;channelrestrict`, `;antiabuse`\n"
                "**+ Management v√† history commands**"
            ),
            inline=True
        )
        
        embed.add_field(
            name="üõí Shop System (10+ l·ªánh)",
            value=(
                "`;shop`, `;buy`, `;setshop`, `;role`\n"
                "`;stop`, `;refund`, `;giveexp`\n"
                "**+ Configuration commands**"
            ),
            inline=True
        )
        
        embed.add_field(
            name="ü§ñ AI & Utils (20+ l·ªánh)",
            value=(
                "`;ask`, `;afk`, `;bye`, `;purge`\n"
                "`;info`, `;ping`, `;reload`, `;backup`\n"
                "**+ System management commands**"
            ),
            inline=True
        )
        
        embed.add_field(
            name="üîÑ Reset System (5 l·ªánh)",
            value=(
                "`;resetuser`, `;resetall`, `;resetgames`\n"
                "`;resetmoney`, `;resetstats`\n"
                "**‚ö†Ô∏è C·ª±c k·ª≥ nguy hi·ªÉm**"
            ),
            inline=True
        )
        
        embed.add_field(
            name="üìä T·ªïng C·ªông",
            value=(
                "**80+ l·ªánh** t√≠ch h·ª£p trong bot\n"
                "**6 categories** ch√≠nh\n"
                "**Multiple permission levels**\n"
                "**Interactive buttons & embeds**"
            ),
            inline=True
        )
        
        embed.add_field(
            name="üîë Permission Levels",
            value=(
                "üëë **Supreme Admin** - T·∫•t c·∫£ l·ªánh\n"
                "üõ°Ô∏è **Admin** - H·∫ßu h·∫øt l·ªánh moderation\n"
                "üë• **User** - Games v√† basic commands"
            ),
            inline=False
        )
        
        embed.set_footer(text="S·ª≠ d·ª•ng buttons ƒë·ªÉ xem chi ti·∫øt t·ª´ng category ‚Ä¢ Total: 80+ commands")
        await interaction.response.edit_message(embed=embed, view=self)
    
    @discord.ui.button(label="üè† Home", style=discord.ButtonStyle.success, emoji="üè†")
    async def home_button(self, interaction: discord.Interaction, button: discord.ui.Button):
        embed = discord.Embed(
            title="üè† Bot Command Center",
            description="Ch√†o m·ª´ng ƒë·∫øn v·ªõi menu l·ªánh ƒë·∫ßy ƒë·ªß c·ªßa bot!",
            color=discord.Color.gold(),
            timestamp=datetime.now()
        )
        
        embed.add_field(
            name="üìã H∆∞·ªõng D·∫´n S·ª≠ D·ª•ng",
            value=(
                "üéÆ **Games** - T·∫•t c·∫£ games v√† gi·∫£i tr√≠\n"
                "üëë **Admin Panel** - L·ªánh qu·∫£n l√Ω v√† moderation\n"
                "üõí **Shop** - H·ªá th·ªëng mua b√°n EXP Rare\n"
                "ü§ñ **AI & Utils** - AI commands v√† ti·ªán √≠ch\n"
                "üõ°Ô∏è **Anti-Abuse** - H·ªá th·ªëng ch·ªëng x√∫c ph·∫°m\n"
                "üîÑ **Reset** - H·ªá th·ªëng reset d·ªØ li·ªáu\n"
                "üìã **All Commands** - T·ªïng quan t·∫•t c·∫£ l·ªánh"
            ),
            inline=False
        )
        
        embed.add_field(
            name="üë§ Quy·ªÅn C·ªßa B·∫°n",
            value=(
                f"**Role:** {'üëë Supreme Admin' if self.bot_instance.is_supreme_admin(interaction.user.id) else 'üõ°Ô∏è Admin' if self.bot_instance.is_admin(interaction.user.id) else 'üë• User'}\n"
                f"**C√≥ th·ªÉ d√πng:** {'T·∫•t c·∫£ l·ªánh' if self.bot_instance.is_supreme_admin(interaction.user.id) else 'H·∫ßu h·∫øt l·ªánh' if self.bot_instance.is_admin(interaction.user.id) else 'L·ªánh c∆° b·∫£n'}"
            ),
            inline=True
        )
        
        embed.add_field(
            name="üí° L∆∞u √ù",
            value=(
                "‚Ä¢ **Prefix:** T·∫•t c·∫£ l·ªánh b·∫Øt ƒë·∫ßu b·∫±ng `;`\n"
                "‚Ä¢ **Rate Limit:** 1 l·ªánh/3s (Admin bypass)\n"
                "‚Ä¢ **Interactive:** S·ª≠ d·ª•ng buttons ƒë·ªÉ ƒëi·ªÅu h∆∞·ªõng\n"
                "‚Ä¢ **Help:** G√µ `;help <l·ªánh>` ƒë·ªÉ xem chi ti·∫øt"
            ),
            inline=True
        )
        
        embed.add_field(
            name="üéØ Quick Access",
            value=(
                "`;fullmenu` - Menu ƒë·∫ßy ƒë·ªß n√†y\n"
                "`;weeklytop` - B·∫£ng x·∫øp h·∫°ng tu·∫ßn\n"
                "`;cauca` - C√¢u c√° ki·∫øm ti·ªÅn\n"
                "`;ask <c√¢u h·ªèi>` - Chat v·ªõi AI\n"
                "`;antiabuse` - H·ªá th·ªëng ch·ªëng x√∫c ph·∫°m"
            ),
            inline=False
        )
        
        embed.set_footer(text=f"Bot Command Center ‚Ä¢ {datetime.now().strftime('%H:%M')} ‚Ä¢ Click buttons ƒë·ªÉ explore!")
        await interaction.response.edit_message(embed=embed, view=self)

class FullMenuCommands:
    def __init__(self, bot_instance):
        self.bot_instance = bot_instance
        self.bot = bot_instance.bot
    
    def register_commands(self):
        """Register full menu commands"""
        
        @self.bot.command(name='fullmenu')
        async def full_menu_command(ctx):
            """Menu ƒë·∫ßy ƒë·ªß v·ªõi t·∫•t c·∫£ l·ªánh c·ªßa bot"""
            try:
                embed = discord.Embed(
                    title="üè† Bot Command Center",
                    description="Ch√†o m·ª´ng ƒë·∫øn v·ªõi menu l·ªánh ƒë·∫ßy ƒë·ªß c·ªßa bot!",
                    color=discord.Color.gold(),
                    timestamp=datetime.now()
                )
                
                embed.add_field(
                    name="üìã H∆∞·ªõng D·∫´n S·ª≠ D·ª•ng",
                    value=(
                        "üéÆ **Games** - T·∫•t c·∫£ games v√† gi·∫£i tr√≠\n"
                        "üëë **Admin Panel** - L·ªánh qu·∫£n l√Ω v√† moderation\n"
                        "üõí **Shop** - H·ªá th·ªëng mua b√°n EXP Rare\n"
                        "ü§ñ **AI & Utils** - AI commands v√† ti·ªán √≠ch\n"
                        "üõ°Ô∏è **Anti-Abuse** - H·ªá th·ªëng ch·ªëng x√∫c ph·∫°m\n"
                        "üîÑ **Reset** - H·ªá th·ªëng reset d·ªØ li·ªáu\n"
                        "üìã **All Commands** - T·ªïng quan t·∫•t c·∫£ l·ªánh"
                    ),
                    inline=False
                )
                
                embed.add_field(
                    name="üë§ Quy·ªÅn C·ªßa B·∫°n",
                    value=(
                        f"**Role:** {'üëë Supreme Admin' if self.bot_instance.is_supreme_admin(ctx.author.id) else 'üõ°Ô∏è Admin' if self.bot_instance.is_admin(ctx.author.id) else 'üë• User'}\n"
                        f"**C√≥ th·ªÉ d√πng:** {'T·∫•t c·∫£ l·ªánh' if self.bot_instance.is_supreme_admin(ctx.author.id) else 'H·∫ßu h·∫øt l·ªánh' if self.bot_instance.is_admin(ctx.author.id) else 'L·ªánh c∆° b·∫£n'}"
                    ),
                    inline=True
                )
                
                embed.add_field(
                    name="üí° L∆∞u √ù",
                    value=(
                        "‚Ä¢ **Prefix:** T·∫•t c·∫£ l·ªánh b·∫Øt ƒë·∫ßu b·∫±ng `;`\n"
                        "‚Ä¢ **Rate Limit:** 1 l·ªánh/3s (Admin bypass)\n"
                        "‚Ä¢ **Interactive:** S·ª≠ d·ª•ng buttons ƒë·ªÉ ƒëi·ªÅu h∆∞·ªõng\n"
                        "‚Ä¢ **Help:** G√µ `;help <l·ªánh>` ƒë·ªÉ xem chi ti·∫øt"
                    ),
                    inline=True
                )
                
                embed.add_field(
                    name="üéØ Quick Access",
                    value=(
                        "`;fullmenu` - Menu ƒë·∫ßy ƒë·ªß n√†y\n"
                        "`;weeklytop` - B·∫£ng x·∫øp h·∫°ng tu·∫ßn\n"
                        "`;cauca` - C√¢u c√° ki·∫øm ti·ªÅn\n"
                        "`;ask <c√¢u h·ªèi>` - Chat v·ªõi AI\n"
                        "`;antiabuse` - H·ªá th·ªëng ch·ªëng x√∫c ph·∫°m"
                    ),
                    inline=False
                )
                
                embed.set_footer(text=f"Bot Command Center ‚Ä¢ {datetime.now().strftime('%H:%M')} ‚Ä¢ Click buttons ƒë·ªÉ explore!")
                
                view = FullMenuView(self.bot_instance)
                await ctx.reply(embed=embed, view=view, mention_author=True)
                
            except Exception as e:
                logger.error(f"L·ªói trong full menu command: {e}")
                await ctx.reply(f"‚ùå C√≥ l·ªói x·∫£y ra: {str(e)}", mention_author=True)
        
        # Alias commands
        @self.bot.command(name='allmenu')
        async def all_menu_alias(ctx):
            """Alias cho fullmenu"""
            await full_menu_command(ctx)
        
        @self.bot.command(name='commandcenter')
        async def command_center_alias(ctx):
            """Alias cho fullmenu"""
            await full_menu_command(ctx)
        
        # L·ªánh menu ƒë√£ t·ªìn t·∫°i trong game_menu_commands.py
